FROM node:22-alpine

WORKDIR /app

# Copy package.json and package-lock.json
COPY package*.json ./

# Copy Jest configuration
COPY jest.config.js ./

# Install all dependencies including dev dependencies
RUN npm install

# Copy source code and tests
COPY ./index.js /app/index.js
COPY ./utils.js /app/utils.js
COPY ./answerMap.json /app/answerMap.json
COPY ./tests /app/tests

# Run tests with coverage
CMD ["npm", "run", "test:coverage"]